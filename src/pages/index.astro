---
export const prerender = false;

import { supabase } from "../lib/supabase";

const siteUrl = import.meta.env.SITE_URL ?? "https://luxexpose-astro.vercel.app";

// Get latest published articles
const { data: articles, error } = await supabase
  .from("public_articles")
  .select("title, slug, excerpt, featured_image, published_at")
  .order("published_at", { ascending: false })
  .limit(20);

if (error) console.error(error);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Lux Exposé | Luxury Lifestyle</title>
    <link rel="canonical" href={siteUrl} />

    <meta name="description" content="Luxury lifestyle editorial, destinations, experiences, and elite culture—powered by Lux Exposé." />

    <meta property="og:title" content="Lux Exposé | Luxury Lifestyle" />
    <meta property="og:description" content="Luxury lifestyle editorial, destinations, experiences, and elite culture—powered by Lux Exposé." />
    <meta property="og:image" content="https://luxexpose.com/wp-content/uploads/2023/08/LuxExpose-Logo.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:url" content={siteUrl} />
    <meta property="og:type" content="website" />

    <meta name="twitter:card" content="summary_large_image" />
  </head>

  <body style="max-width:980px;margin:40px auto;padding:0 16px;font-family:system-ui;line-height:1.6;">
    <header style="margin-bottom:28px;">
      <h1 style="margin:0;">Lux Exposé</h1>
      <p style="opacity:.75;margin:8px 0 0;">
        Luxury lifestyle editorial, destinations, experiences, and elite culture.
      </p>
    </header>

    <main>
      <h2 style="margin:0 0 12px;">Latest Articles</h2>

      {(!articles || articles.length === 0) ? (
        <p style="opacity:.75;">No articles found.</p>
      ) : (
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;">
          {articles.map((a) => (
            <a
              href={`/${a.slug}`}
              style="display:block;border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:14px;text-decoration:none;color:inherit;"
            >
              {a.featured_image && (
                <img
                  src={a.featured_image}
                  alt={a.title}
                  loading="lazy"
                  style="width:100%;height:180px;object-fit:cover;border-radius:10px;margin-bottom:10px;"
                />
              )}

              <h3 style="margin:0 0 8px;font-size:18px;">{a.title}</h3>

              {a.excerpt && (
                <p style="margin:0;opacity:.75;font-size:14px;">
                  {a.excerpt}
                </p>
              )}
            </a>
          ))}
        </div>
      )}
    </main>
  </body>
</html>