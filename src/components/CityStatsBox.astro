---
// src/components/CityStatsBox.astro
interface CityStat {
  icon: "michelin" | "landmarks" | "cultural" | "hotels" | "growth";
  label: string;
  value: string;
  description: string;
}

interface Props {
  cityName: string;
  citySlug?: string;  // 'boston' | 'miami' | 'nyc' | 'doha'
  stats: CityStat[];
  explorationHeadline?: string;
  explorationSubtext?: string;
  className?: string;
}

const { cityName, citySlug = 'boston', stats, explorationHeadline, explorationSubtext, className = "" } = Astro.props;

// City-specific gold color class
const goldColorClass = {
  boston: 'text-boston-gold',
  miami: 'text-miami-turquoise',
  nyc: 'text-nyc-gold',
  doha: 'text-doha-gold'
}[citySlug] || 'text-luxury-gold';

// Icon SVG paths (Lucide icons)
const iconPaths = {
  michelin: '<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>',
  landmarks: '<line x1="3" x2="21" y1="22" y2="22"/><line x1="6" x2="6" y1="18" y2="11"/><line x1="10" x2="10" y1="18" y2="11"/><line x1="14" x2="14" y1="18" y2="11"/><line x1="18" x2="18" y1="18" y2="11"/><polygon points="12 2 20 7 4 7"/>',
  cultural: '<circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/>',
  hotels: '<path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/>',
  growth: '<polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/>'
};
---

<section class={`stats-section ${className}`}>
  <div class="container mx-auto px-4">
    <div 
      class="stats-container glass-card-dark rounded-3xl p-8 md:p-12 relative overflow-hidden"
      data-scroll-reveal
    >
      <!-- Background accent orb -->
      <div 
        class="absolute top-0 right-0 w-96 h-96 rounded-full blur-3xl -z-10 animate-pulse-glow"
        style={`background: hsl(var(--${citySlug}-gold) / 0.05);`}
      ></div>
      
      <!-- Header -->
      <div class="text-center mb-12">
        <h2 class="font-serif text-3xl md:text-4xl font-bold mb-3" style="color: hsl(0 0% 98%);">
          {explorationHeadline || `${cityName} by the Numbers`}
        </h2>
        <p class="text-lg" style="color: hsl(0 0% 60%);">
          {explorationSubtext || "A glimpse into the city's luxury landscape"}
        </p>
      </div>

      <!-- Stats Grid -->
      <div class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6">
        {stats.map((stat) => (
          <div class="glass-card-subtle rounded-2xl p-6 text-center group transition-all duration-300 hover:border-opacity-30"
               style={`border-color: hsl(var(--${citySlug}-gold) / 0.2);`}>
            <!-- Icon container -->
            <div class="inline-flex items-center justify-center w-16 h-16 rounded-full glass-card-dark mb-4 group-hover:scale-110 transition-transform"
                 style={`border: 0.5px solid hsl(var(--${citySlug}-gold) / 0.3);`}>
              <svg 
                width="32" 
                height="32" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                stroke-width="2" 
                stroke-linecap="round" 
                stroke-linejoin="round"
                class={goldColorClass}
                set:html={iconPaths[stat.icon] || '<circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>'}
              />
            </div>
            
            <!-- Value -->
            <div class="text-3xl font-bold font-serif mb-2" style="color: hsl(0 0% 98%);">
              {stat.value}
            </div>
            
            <!-- Label -->
            <div class={`text-sm font-semibold mb-2 ${goldColorClass}`}>
              {stat.label}
            </div>
            
            <!-- Description -->
            <div class="text-xs leading-relaxed" style="color: hsl(0 0% 60%);">
              {stat.description}
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  /* Section */
  .stats-section {
    padding-top: 4rem; /* py-16 = 64px */
    padding-bottom: 4rem;
  }

  .container {
    max-width: 1280px;
    margin: 0 auto;
    padding-left: 1rem; /* px-4 = 16px */
    padding-right: 1rem;
  }

  /* Main Glass Card */
  .stats-container {
    position: relative;
    overflow: hidden;
    border-radius: 1.5rem; /* rounded-3xl = 24px */
    padding: 2rem; /* p-8 = 32px mobile */
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(24px) saturate(180%);
    -webkit-backdrop-filter: blur(24px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 
      0 4px 24px 0 rgba(0, 0, 0, 0.2),
      inset 0 0.5px 0 0 rgba(255, 255, 255, 0.1);
  }

  @media (min-width: 768px) {
    .stats-container {
      padding: 3rem; /* md:p-12 = 48px desktop */
    }
  }

  /* Background Accent Orb */
  .background-orb {
    position: absolute;
    top: 0;
    right: 0;
    width: 24rem; /* w-96 = 384px */
    height: 24rem;
    background-color: hsla(43, 74%, 52%, 0.05); /* bg-boston-gold/5 */
    border-radius: 50%;
    filter: blur(64px); /* blur-3xl */
    -webkit-filter: blur(64px);
    z-index: -1;
    animation: pulse-glow 4s ease-in-out infinite;
  }

  /* Header Group */
  .header-group {
    text-align: center;
    margin-bottom: 3rem; /* mb-12 = 48px */
  }

  /* Typography - handled by inline styles and Tailwind classes */

  /* Stats Grid */
  .stats-grid {
    display: grid;
    gap: 1.5rem; /* gap-6 = 24px */
    grid-template-columns: 1fr; /* Mobile: 1 column */
  }

  @media (min-width: 768px) {
    .stats-grid {
      grid-template-columns: repeat(2, 1fr); /* md: 2 columns */
    }
  }

  @media (min-width: 1024px) {
    .stats-grid {
      grid-template-columns: repeat(3, 1fr); /* lg: 3 columns */
    }
  }

  @media (min-width: 1280px) {
    .stats-grid {
      grid-template-columns: repeat(5, 1fr); /* xl: 5 columns */
    }
  }

  /* Stat card hover effects handled by inline styles and Tailwind */

  /* Hover effects handled by Tailwind classes */

  /* Stat Value */
  /* City gold colors */
  .text-boston-gold { color: hsl(43 74% 52%); }
  .text-miami-turquoise { color: hsl(174 70% 56%); }
  .text-nyc-gold { color: hsl(51 100% 50%); }
  .text-doha-gold { color: hsl(43 85% 55%); }
  .text-luxury-gold { color: hsl(43 35% 48%); }
  
  /* Typography */
  .font-serif {
    font-family: 'Cormorant Garamond', Georgia, serif;
  }
  
  .leading-relaxed {
    line-height: 1.625; /* relaxed = 1.625 */
  }

  /* Pulse Glow Animation */
  @keyframes pulse-glow {
    0%, 100% { 
      opacity: 0.3; 
    }
    50% { 
      opacity: 0.6; 
    }
  }

  /* Scroll reveal */
  [data-scroll-reveal] {
    opacity: 0;
    transform: scale(0.95);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }
  
  [data-scroll-reveal].is-visible {
    opacity: 1;
    transform: scale(1);
  }
</style>

<script is:inline>
  // Intersection Observer for scroll reveal
  (function() {
    if (typeof window === 'undefined') return;
    
    function initScrollReveal() {
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.1 }
      );

      document.querySelectorAll('[data-scroll-reveal]').forEach((el) => {
        observer.observe(el);
      });
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initScrollReveal);
    } else {
      initScrollReveal();
    }
  })();
</script>
