---
// src/components/CityStatsBox.astro
interface CityStat {
  icon: "michelin" | "landmarks" | "cultural" | "hotels" | "growth";
  label: string;
  value: string;
  description: string;
}

interface Props {
  cityName: string;
  citySlug?: string;  // 'boston' | 'miami' | 'nyc' | 'doha'
  stats: CityStat[];
  className?: string;
}

const { cityName, citySlug = 'boston', stats, className = "" } = Astro.props;

// City-specific gold color class
const goldColorClass = {
  boston: 'text-boston-gold',
  miami: 'text-miami-turquoise',
  nyc: 'text-nyc-gold',
  doha: 'text-doha-gold'
}[citySlug] || 'text-luxury-gold';

// Icon SVG paths (Lucide icons)
const iconPaths = {
  michelin: '<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>',
  landmarks: '<line x1="3" x2="21" y1="22" y2="22"/><line x1="6" x2="6" y1="18" y2="11"/><line x1="10" x2="10" y1="18" y2="11"/><line x1="14" x2="14" y1="18" y2="11"/><line x1="18" x2="18" y1="18" y2="11"/><polygon points="12 2 20 7 4 7"/>',
  cultural: '<circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/>',
  hotels: '<path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/>',
  growth: '<polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/>'
};
---

<section class={`stats-section ${className}`}>
  <div class="container mx-auto px-4">
    <div 
      class="stats-container glass-card-dark rounded-3xl p-8 md:p-12 relative overflow-hidden"
      data-scroll-reveal
    >
      <!-- Background accent orb -->
      <div 
        class="absolute top-0 right-0 w-96 h-96 rounded-full blur-3xl -z-10 animate-pulse-glow"
        style={`background: hsl(var(--${citySlug}-gold) / 0.05);`}
      ></div>
      
      <!-- Header -->
      <div class="text-center mb-12">
        <h2 class="font-serif text-3xl md:text-4xl font-bold mb-3" style="color: hsl(0 0% 98%);">
          {cityName} by the Numbers
        </h2>
        <p class="text-lg" style="color: hsl(0 0% 60%);">
          A glimpse into the city's luxury landscape
        </p>
      </div>

      <!-- Stats Grid - 5 cards top row, 1 card bottom row -->
      <div class="stats-grid-layout">
        {stats.map((stat, index) => {
          const isFirstRow = index < 5;
          const isSecondRow = index === 5;
          return (
            <div 
              class={`stat-card ${isFirstRow ? 'stat-card-first-row' : 'stat-card-second-row'}`}
              style={`border-color: hsl(var(--${citySlug}-gold) / 0.2);`}
            >
              <!-- Icon container -->
              <div class="stat-icon-container"
                   style={`border: 0.5px solid hsl(var(--${citySlug}-gold) / 0.3);`}>
                <svg 
                  width="32" 
                  height="32" 
                  viewBox="0 0 24 24" 
                  fill="none" 
                  stroke="currentColor" 
                  stroke-width="2" 
                  stroke-linecap="round" 
                  stroke-linejoin="round"
                  class={goldColorClass}
                  set:html={iconPaths[stat.icon] || '<circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>'}
                />
              </div>
              
              <!-- Value - Golden and bold -->
              <div class="stat-value" style={`color: hsl(var(--${citySlug}-gold));`}>
                {stat.value}
              </div>
              
              <!-- Label - Golden -->
              <div class={`stat-label ${goldColorClass}`}>
                {stat.label}
              </div>
              
              <!-- Description - White -->
              <div class="stat-description" style="color: hsl(0 0% 98%);">
                {stat.description}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </div>
</section>

<style>
  /* Section */
  .stats-section {
    padding-top: 4rem; /* py-16 = 64px */
    padding-bottom: 4rem;
  }

  .container {
    max-width: 1280px;
    margin: 0 auto;
    padding-left: 1rem; /* px-4 = 16px */
    padding-right: 1rem;
  }

  /* Main Glass Card */
  .stats-container {
    position: relative;
    overflow: hidden;
    border-radius: 1.5rem; /* rounded-3xl = 24px */
    padding: 2rem; /* p-8 = 32px mobile */
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(24px) saturate(180%);
    -webkit-backdrop-filter: blur(24px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 
      0 4px 24px 0 rgba(0, 0, 0, 0.2),
      inset 0 0.5px 0 0 rgba(255, 255, 255, 0.1);
  }

  @media (min-width: 768px) {
    .stats-container {
      padding: 3rem; /* md:p-12 = 48px desktop */
    }
  }

  /* Background Accent Orb */
  .background-orb {
    position: absolute;
    top: 0;
    right: 0;
    width: 24rem; /* w-96 = 384px */
    height: 24rem;
    background-color: hsla(43, 74%, 52%, 0.05); /* bg-boston-gold/5 */
    border-radius: 50%;
    filter: blur(64px); /* blur-3xl */
    -webkit-filter: blur(64px);
    z-index: -1;
    animation: pulse-glow 4s ease-in-out infinite;
  }

  /* Header Group */
  .header-group {
    text-align: center;
    margin-bottom: 3rem; /* mb-12 = 48px */
  }

  /* Typography - handled by inline styles and Tailwind classes */

  /* Stats Grid Layout - 5 cards top row, 1 card bottom row */
  .stats-grid-layout {
    display: grid;
    gap: 1.5rem; /* gap-6 = 24px */
    grid-template-columns: 1fr; /* Mobile: 1 column */
  }

  @media (min-width: 768px) {
    .stats-grid-layout {
      grid-template-columns: repeat(5, 1fr); /* 5 columns for top row */
      grid-template-rows: auto auto; /* 2 rows */
    }
  }

  /* Stat Card */
  .stat-card {
    background: rgba(255, 255, 255, 0.02);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 1rem; /* rounded-2xl = 16px */
    padding: 1.5rem; /* p-6 = 24px */
    text-align: center;
    transition: all 0.3s ease;
  }

  .stat-card:hover {
    border-color: hsl(var(--boston-gold) / 0.4);
    transform: translateY(-2px);
  }

  /* First row cards - 5 columns */
  @media (min-width: 768px) {
    .stat-card-first-row {
      grid-column: span 1;
    }
    
    /* Second row card - spans first column only, aligned left */
    .stat-card-second-row {
      grid-column: 1;
      grid-row: 2;
    }
  }

  /* Icon Container */
  .stat-icon-container {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 4rem; /* w-16 = 64px */
    height: 4rem;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 0.5px solid rgba(255, 255, 255, 0.08);
    margin-bottom: 1rem; /* mb-4 = 16px */
    transition: transform 0.3s ease;
  }

  .stat-card:hover .stat-icon-container {
    transform: scale(1.1);
  }

  /* Stat Value - Golden, bold, large */
  .stat-value {
    font-family: 'Cormorant Garamond', Georgia, serif;
    font-size: 1.875rem; /* text-3xl = 30px */
    font-weight: 700; /* bold */
    line-height: 1.2;
    margin-bottom: 0.5rem; /* mb-2 = 8px */
  }

  /* Stat Label - Golden, semibold */
  .stat-label {
    font-size: 0.875rem; /* text-sm = 14px */
    font-weight: 600; /* semibold */
    margin-bottom: 0.5rem; /* mb-2 = 8px */
  }

  /* Stat Description - White, smaller */
  .stat-description {
    font-size: 0.75rem; /* text-xs = 12px */
    line-height: 1.625; /* leading-relaxed */
    font-weight: 400;
  }

  /* Stat card hover effects handled by inline styles and Tailwind */

  /* Hover effects handled by Tailwind classes */

  /* Stat Value */
  /* City gold colors */
  .text-boston-gold { color: hsl(43 74% 52%); }
  .text-miami-turquoise { color: hsl(174 70% 56%); }
  .text-nyc-gold { color: hsl(51 100% 50%); }
  .text-doha-gold { color: hsl(43 85% 55%); }
  .text-luxury-gold { color: hsl(43 35% 48%); }
  
  /* Typography */
  .font-serif {
    font-family: 'Cormorant Garamond', Georgia, serif;
  }
  
  .leading-relaxed {
    line-height: 1.625; /* relaxed = 1.625 */
  }

  /* Pulse Glow Animation */
  @keyframes pulse-glow {
    0%, 100% { 
      opacity: 0.3; 
    }
    50% { 
      opacity: 0.6; 
    }
  }

  /* Scroll reveal - start visible, animate if JS loads */
  [data-scroll-reveal] {
    opacity: 1; /* Start visible */
    transform: scale(1);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }
  
  /* Only hide if JS marks it for animation */
  [data-scroll-reveal].js-ready:not(.is-visible) {
    opacity: 0;
    transform: scale(0.95);
  }
  
  [data-scroll-reveal].is-visible {
    opacity: 1;
    transform: scale(1);
  }
</style>

<script is:inline>
  // Intersection Observer for scroll reveal
  (function() {
    if (typeof window === 'undefined') return;
    
    function initScrollReveal() {
      const elements = document.querySelectorAll('[data-scroll-reveal]');
      
      // Mark elements as ready for animation
      elements.forEach((el) => {
        el.classList.add('js-ready');
        // Start hidden if JS is available
        el.style.opacity = '0';
        el.style.transform = 'scale(0.95)';
      });
      
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
              entry.target.style.opacity = '1';
              entry.target.style.transform = 'scale(1)';
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.1 }
      );

      elements.forEach((el) => {
        observer.observe(el);
      });
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initScrollReveal);
    } else {
      initScrollReveal();
    }
  })();
</script>
