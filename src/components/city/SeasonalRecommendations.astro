---
import { bostonSeasonalContent } from '../../data/bostonSeasonal';

interface Props {
  cityName: string;
  citySlug: string;
}

const { cityName, citySlug } = Astro.props;

// Determine current season
function getCurrentSeason(): 'winter' | 'spring' | 'summer' | 'fall' {
  const month = new Date().getMonth();
  if (month >= 2 && month <= 4) return 'spring';
  if (month >= 5 && month <= 7) return 'summer';
  if (month >= 8 && month <= 10) return 'fall';
  return 'winter';
}

const currentSeason = getCurrentSeason();
const content = bostonSeasonalContent[currentSeason];
const activities = content?.activities || [];

const REACT_APP_URL = import.meta.env.PUBLIC_REACT_APP_URL || '';

// Season icons SVG
const seasonIcons: Record<string, string> = {
  winter: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/><path d="m20 16-4-4 4-4"/><path d="m4 8 4 4-4 4"/><path d="m16 4-4 4-4-4"/><path d="m8 20 4-4 4 4"/></svg>`,
  spring: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 7.5a4.5 4.5 0 1 1 4.5 4.5M12 7.5A4.5 4.5 0 1 0 7.5 12M12 7.5V9m-4.5 3a4.5 4.5 0 1 0 4.5 4.5M7.5 12H9m3 4.5V15m4.5-3a4.5 4.5 0 1 1-4.5 4.5m4.5-4.5H15m-3-3"/></svg>`,
  summer: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>`,
  fall: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></svg>`
};
---

{activities.length > 0 && (
  <section class="seasonal-section">
    <div class="container">
      <!-- Header -->
      <div class="header">
        <div class="season-badge">
          <span class="season-icon" set:html={seasonIcons[currentSeason]} />
          <span class="season-text">{currentSeason.toUpperCase()} IN {cityName.toUpperCase()}</span>
        </div>
        <h2 class="section-title">Perfect for This Season</h2>
        <p class="section-subtitle">
          Curated experiences that make the most of {cityName}'s {currentSeason} offerings
        </p>
      </div>

      <!-- Cards Grid -->
      <div class="cards-grid">
        {activities.map((activity, index) => (
          <a 
            href={`${REACT_APP_URL}${activity.link}`}
            class="seasonal-card"
            style={`animation-delay: ${index * 0.1}s`}
          >
            <div class="card-image-wrapper">
              <img
                src={activity.image}
                alt={activity.title}
                class="card-image"
                loading="lazy"
              />
              <div class="card-gradient"></div>
            </div>
            
            <div class="card-content">
              <h3 class="card-title">{activity.title}</h3>
              <p class="card-description">{activity.description}</p>
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>
)}

<style>
  /* Color Variables */
  :root {
    --luxury-gold: hsl(43 35% 48%);
    --background: hsl(0 0% 5%);
    --foreground: hsl(0 0% 98%);
    --muted-foreground: hsl(0 0% 64%);
  }

  /* Section */
  .seasonal-section {
    padding: 64px 0;
  }

  .container {
    max-width: 1280px;
    margin: 0 auto;
    padding: 0 16px;
  }

  /* Header */
  .header {
    text-align: center;
    margin-bottom: 48px;
  }

  .season-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    padding: 8px 16px;
    border-radius: 9999px;
    margin-bottom: 16px;
  }

  .season-icon {
    color: var(--luxury-gold);
    display: flex;
    align-items: center;
  }

  .season-text {
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    font-weight: 500;
    color: var(--luxury-gold);
  }

  .section-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 36px;
    font-weight: 700;
    color: var(--foreground);
    margin-bottom: 16px;
  }

  @media (min-width: 768px) {
    .section-title {
      font-size: 48px;
    }
  }

  .section-subtitle {
    font-family: 'Inter', sans-serif;
    font-size: 18px;
    font-weight: 400;
    color: var(--muted-foreground);
    max-width: 672px;
    margin: 0 auto;
  }

  /* Cards Grid */
  .cards-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 24px;
  }

  @media (min-width: 768px) {
    .cards-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  /* Seasonal Card */
  .seasonal-card {
    position: relative;
    overflow: hidden;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 500ms ease;
    cursor: pointer;
    display: block;
    text-decoration: none;
    animation: fadeInUp 600ms ease forwards;
    opacity: 0;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .seasonal-card:hover {
    border-color: rgba(184, 157, 102, 0.5);
    transform: translateY(-4px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
  }

  /* Image */
  .card-image-wrapper {
    aspect-ratio: 4 / 3;
    overflow: hidden;
    position: relative;
  }

  .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 700ms ease;
  }

  .seasonal-card:hover .card-image {
    transform: scale(1.1);
  }

  /* Gradient */
  .card-gradient {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to top,
      var(--background) 0%,
      rgba(13, 13, 13, 0.6) 50%,
      transparent 100%
    );
  }

  /* Content */
  .card-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 24px;
  }

  .card-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 20px;
    font-weight: 700;
    color: var(--foreground);
    margin-bottom: 8px;
    transition: color 300ms ease;
  }

  .seasonal-card:hover .card-title {
    color: var(--luxury-gold);
  }

  .card-description {
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    font-weight: 400;
    color: var(--muted-foreground);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

