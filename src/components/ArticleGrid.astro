---
interface Article {
  id?: string;
  title: string;
  slug: string;
  excerpt?: string;
  published_at?: string;
  featured_image?: string;
  categories?: { name?: string; slug?: string } | null;
}

interface Props {
  articles?: Article[];
}

const { articles = [] } = Astro.props;

function formatDate(value: string | undefined): string {
  if (!value) return "";
  try {
    const d = new Date(value);
    return d.toLocaleDateString("en-US", {
      year: "numeric",
      month: "short",
      day: "numeric",
    });
  } catch {
    return value || "";
  }
}
---

{articles.length > 0 ? (
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
    {articles.map((article) => {
      const href = article.slug?.startsWith("/") ? article.slug : `/${article.slug}`;
      const categoryName = article.categories?.name || "";

      return (
        <a
          href={href}
          class="group block overflow-hidden rounded-xl border border-white/10 glass-card-dark lux-hover-lift"
        >
          <div class="relative w-full aspect-[16/9] overflow-hidden bg-black/60">
            {article.featured_image ? (
              <img
                src={article.featured_image}
                alt={article.title}
                loading="lazy"
                class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.03]"
              />
            ) : (
              <div class="h-full w-full bg-white/5 border-b border-white/10"></div>
            )}

            {categoryName && (
              <div class="absolute top-4 left-4 px-3 py-1.5 rounded-full bg-black/70 backdrop-blur-sm border border-white/20">
                <span class="text-xs uppercase tracking-wider text-white/90 font-medium">
                  {categoryName}
                </span>
              </div>
            )}
          </div>

          <div class="p-6">
            {article.published_at && (
              <p class="mb-3 text-xs uppercase tracking-[0.2em] text-white/45">
                {formatDate(article.published_at)}
              </p>
            )}

            <h3 class="font-serif text-xl md:text-2xl leading-tight text-white mb-3 transition-colors duration-300 group-hover:text-[hsl(var(--luxury-gold))]">
              {article.title}
            </h3>

            {article.excerpt ? (
              <p
                class="text-white/70 text-sm leading-relaxed overflow-hidden [display:-webkit-box] [-webkit-line-clamp:2] [-webkit-box-orient:vertical]"
              >
                {article.excerpt}
              </p>
            ) : null}
          </div>
        </a>
      );
    })}
  </div>
) : (
  <div class="rounded-xl border border-white/10 bg-black/40 p-12 text-center">
    <p class="text-white/60 text-lg">No articles found.</p>
  </div>
)}

